<view class="page">
    <view class="page__bd">
        <view class="weui-search-bar">
            <view class="weui-search-bar__form">
                <view class="weui-search-bar__box">
                    <icon class="weui-icon-search_in-box" type="search" size="14"></icon>
                    <input type="text" class="weui-search-bar__input" placeholder="输入书名、作者、出版社" bindinput="bindSearchInput" value="{{search}}" />
                </view>
            </view>
            <view class="weui-search-bar__cancel-btn" bindtap="search">搜索</view>
            <view class="weui-search-bar__cancel-btn" bindtap="scan">扫码</view>
        </view>
        <block wx:if="{{flag}}">
            <view class="weui-cells searchbar-result">
                <block wx:for="{{result_list}}" wx:key="{{item.id}}">
                    <navigator url="../book/detail?id={{item.id}}" class="weui-media-box weui-media-box_appmsg" hover-class="weui-cell_active">
                        <view class="weui-media-box__hd weui-media-box__hd_in-appmsg">
                            <image class="weui-media-box__thumb" src="{{item.img}}" />
                        </view>
                        <view class="weui-media-box__bd weui-media-box__bd_in-appmsg">
                            <view class="weui-media-box__title">{{item.title}}</view>
                            <view class="weui-media-box__desc">{{item.intro}}</view>
                            <view class="weui-media-box__info">
                                <view class="weui-media-box__info__meta">作者：{{item.author.data.name_cn}}</view>
                                <view class="weui-media-box__info__meta">出版社：{{item.publish_house}}</view>
                            </view>
                        </view>
                    </navigator>
                </block>
                <block wx:if="{{flag && result_list.length == 0}}">
                    <view class="weui-cell" hover-class="weui-cell_active">
                        <view class="weui-cell__bd">
                            <view>没有找到您想要搜索的内容</view>
                        </view>
                    </view>
                </block>
            </view>
        </block>
        <block wx:else>
            <block wx:if="{{history.length > 0}}">
                <view class="weui-cells">
                    <view class="weui-cell" hover-class="weui-cell_active">
                        <view class="weui-cell__bd">
                            <view style="color:red" bindtap="clearHistory">清除记录</view>
                        </view>
                    </view>
                </view>
                <view class="weui-cells">
                    <block wx:for="{{history}}" wx:key="{{item}}">
                        <view class="weui-cell" hover-class="weui-cell_active">
                            <view class="weui-cell__bd">
                                <view data-search="{{item}}" bindtap="tapHistory">{{item}}</view>
                            </view>
                        </view>
                    </block>
                </view>
            </block>
        </block>
    </view>
</view>